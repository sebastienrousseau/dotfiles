#!/usr/bin/env bash

# run_onchange_linux_install-packages.sh.tmpl
{{- if eq .chezmoi.os "linux" -}}

# Strict error handling
set -euo pipefail

log_info() { echo -e "\n[INFO] $*"; }
log_error() { echo -e "\n[ERROR] $*" >&2; }

log_info "ğŸ§ Linux: Starting setup..."

if command -v apt-get >/dev/null; then
  log_info "Updating packages..."
  
  # Check if we have sudo or if we're root
  sudo_cmd=""
  if command -v sudo >/dev/null; then
    sudo_cmd="sudo"
  elif [ "$(id -u)" -ne 0 ]; then
    log_error "This script requires root privileges or sudo."
    exit 1
  fi

  $sudo_cmd apt-get update
  # Add your packages here
  # packages=(
  #   curl
  #   git
  #   zsh
  # )
  # sudo apt-get install -y "${packages[@]}"
fi

log_info "ğŸ§ Linux: Setup complete."
{{- end -}}
