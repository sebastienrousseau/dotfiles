#!/bin/sh
# Interactive Tour using Gum
# Part of Dotfiles v0.2.474

if ! command -v gum >/dev/null; then
    echo "Error: 'gum' is not installed."
    case "$(uname -s)" in
        Darwin)
            echo "Install: brew install gum"
            ;;
        Linux)
            if command -v snap >/dev/null; then
                echo "Install: sudo snap install gum --classic"
            else
                echo "Install: go install github.com/charmbracelet/gum@latest"
            fi
            ;;
        *)
            echo "Install gum from: https://github.com/charmbracelet/gum"
            ;;
    esac
    exit 1
fi

clear

# Intro (match UI header style)
gum style \
    --foreground 212 --border-foreground 212 --border double \
    --align center --width 62 --margin "1 2" --padding "1 2" \
    "██████╗  ██████╗ ████████╗███████╗██╗██╗     ███████╗███████╗" \
    "██╔══██╗██╔═══██╗╚══██╔══╝██╔════╝██║██║     ██╔════╝██╔════╝" \
    "██║  ██║██║   ██║   ██║   █████╗  ██║██║     █████╗  ███████╗" \
    "██║  ██║██║   ██║   ██║   ██╔══╝  ██║██║     ██╔══╝  ╚════██║" \
    "██████╔╝╚██████╔╝   ██║   ██║     ██║███████╗███████╗███████║" \
    "╚═════╝  ╚═════╝    ╚═╝   ╚═╝     ╚═╝╚══════╝╚══════╝╚══════╝" \
    "" \
    "v0.2.474 · Infrastructure‑grade shell environment"

echo ""
gum confirm "Ready to take a quick guided tour?" || exit 0
clear

# Slide 1: Core workflow
gum style \
    --foreground 99 --border rounded --padding "1 2" --margin "1 2" \
    "Core workflow (safe + repeatable)" \
    " " \
    "dot apply     # Apply your dotfiles" \
    "dot update    # Pull + apply updates" \
    "dot diff      # See local changes (excludes scripts)" \
    "dot drift     # Snapshot config drift"

echo ""
gum confirm "Next: Diagnostics" || exit 0
clear

# Slide 2: Diagnostics
gum style \
    --foreground 75 --border rounded --padding "1 2" --margin "1 2" \
    "Diagnostics & insight" \
    " " \
    "dot doctor    # Health checks" \
    "dot history   # Shell history analysis" \
    "dot benchmark # Startup timing"

echo ""
gum confirm "Next: Secrets" || exit 0
clear

# Slide 3: Secrets
gum style \
    --foreground 214 --border rounded --padding "1 2" --margin "1 2" \
    "Secrets (age)" \
    " " \
    "dot secrets-init   # Create age key" \
    "dot secrets        # Edit encrypted secrets" \
    "dot secrets-create # Create encrypted file" \
    "dot ssh-key        # Encrypt an SSH key locally"

echo ""
gum confirm "Next: Security (opt‑in)" || exit 0
clear

# Slide 4: Security (opt-in)
gum style \
    --foreground 150 --border rounded --padding "1 2" --margin "1 2" \
    "Security (opt‑in)" \
    " " \
    "dot firewall     # Firewall hardening" \
    "dot telemetry    # Disable OS telemetry" \
    "dot dns-doh      # Enable DNS‑over‑HTTPS (Linux)" \
    "dot lock-screen  # Idle lock settings" \
    "dot usb-safety   # Disable automount" \
    "dot encrypt-check # Disk encryption status"

echo ""
gum style \
    --foreground 212 --border rounded --padding "1 2" --margin "1 2" \
    "Themes & UX" \
    " " \
    "dot theme      # Switch terminal theme" \
    "dot wallpaper  # Apply wallpaper" \
    "dot fonts      # Install Nerd Fonts" \
    "dot keys       # Keybindings catalog" \
    "dot tools      # Curated utilities"
echo ""

gum confirm "Next: Projects & Sandbox" || exit 0
clear

# Slide 5: Projects & Sandbox
gum style \
    --foreground 111 --border rounded --padding "1 2" --margin "1 2" \
    "Projects & sandbox" \
    " " \
    "dot new <lang> <name>  # Templates: python, go, node" \
    "dot sandbox            # Safe preview (Docker/Podman)" \
    "dot edit               # Open source in editor"

echo ""
gum style \
    --foreground 212 --margin "1 2" \
    "You’re all set. Tip: run 'dot update' weekly to stay current."
echo ""
